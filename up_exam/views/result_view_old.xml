<?xml version="1.0" encoding="utf-8"?>
<odoo>


    <template id="exam_report_document">
        <t t-call="web.html_container">

            <style>
                .main-page {
                border: 1px solid #000;
                padding: 10px;
                font-family: "Arial", sans-serif;
                color: #000;
                }
                .student-information {
                font-size: 16px;
                background: #EFF6FF;
                border: 1px solid #000;
                margin-top: 10px;
                }
                .student-information table td {
                border: 1px solid #000;
                padding: 6px;
                }
                .student-information .ur_text {
                text-align: right;
                }

                /* General Table */
                table {
                width: 100%;
                border-collapse: collapse;
                }

                /* Marks Table */
                .marks-details table th {
                background: #FFA2A2;
                color: #000;
                border: 1px solid #000;
                padding: 6px;
                font-size: 17px;
                text-align: center;
                }
                .marks-details table td {
                border: 1px solid #000;
                padding: 8px;
                font-size: 17px;
                text-align: center;
                }

                /* Totals row */
                .totals td {
                background: #FFD6A7;
                font-weight: bold;
                }

                /* Urdu style */
                .urdu {
                font-family: "Jameel Noori Nastaleeq", "Arial";
                direction: rtl;
                }

                .result-marks-state table td {
                text-align: center;
                padding: 15px;
                font-size: 16px;
                border-bottom: 1px solid #000;
                }

                .heading-title {
                font-size: 22px;
                font-weight: bold;
                color: red;
                text-align: center;
                margin: 10px 0;
                }

                .signature-sec table td {
                padding-top: 60px;
                text-align: center;
                font-size: 15px;
                font-weight: bold;
                }


            </style>

            <!-- OUTER PAGE -->
            <div class="main-page">

                <!-- Header -->
                <div style="text-align:center; margin-bottom: 15px;">
                    <t t-set="school" t-value="doc.env['school.school'].search([], limit=1)"/>
                    <img t-if="school.result_card_header"
                         t-att-src="image_data_uri(school.result_card_header)"
                         style="width:100%; object-fit:cover;"/>
                </div>

                <div class="heading-title">
                    (<span>MARKSHEET</span> / <span class="urdu">مارک شیٹ</span>)
                </div>

                <!-- Student Information -->
                <div class="student-information">
                    <table>
                        <tr>
                            <td>Student's Name</td>
                            <td colspan="4" style="text-align:center;">
                                <span t-esc="doc.student_id.name"/>
                            </td>
                            <td class="ur_text urdu">نام طالب علم</td>
                        </tr>

                        <tr>
                            <td>Father's Name</td>
                            <td colspan="4" style="text-align:center;">
                                <span t-esc="doc.student_id.father_name"/>
                            </td>
                            <td class="ur_text urdu">والد کا نام</td>
                        </tr>

                        <tr>
                            <td>Reg. No</td>
                            <td style="text-align:center" t-esc="doc.student_id.reg_no"/>
                            <td class="ur_text urdu">رجسٹریشن نمبر</td>

                            <td>Roll No</td>
                            <td style="text-align:center" t-esc="doc.roll_no"/>
                            <td class="ur_text urdu">رول نمبر</td>
                        </tr>

                        <tr>
                            <td>Academic Year</td>
                            <td style="text-align:center" t-esc="doc.exam_id.academic_year"/>
                            <td class="ur_text urdu">تعلیمی سال</td>

                            <td>Class</td>
                            <td style="text-align:center" t-esc="doc.class_id.name"/>
                            <td class="ur_text urdu">درجہ</td>
                        </tr>
                    </table>
                </div>

                <!-- Result + Marks -->
                <div class="result-marks-state">
                    <table style="width:100%">
                        <tr>
                            <td>
                                <table style="border:none;">
                                    <tr>
                                        <td style="font-weight:bold; padding:20px 0;">
                                            <span>RESULT /</span>
                                            <span class="urdu">نتیجہ</span>
                                            <br/>
                                            <span t-esc="doc.result"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight:bold; padding:20px 0;">
                                            <span>DIVISION</span>
                                            <br/>
                                            <span t-esc="doc.division"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight:bold; padding:20px 0;">
                                            <span>PERCENTAGE</span>
                                            <br/>
                                            <span t-esc="doc.percentage"/>%
                                        </td>
                                    </tr>

                                    <tr>
                                        <td style="font-weight:bold; padding:20px 0;">
                                            <span class="urdu">درجہ میں پوزیشن</span>
                                            <br/>
                                            <span t-esc="doc.position"/>
                                        </td>
                                    </tr>

                                </table>
                            </td>

                            <!-- RIGHT — MARKS TABLE -->
                            <td style="">
                                                              <div class="marks-details">
                                    <table style="width:100%; table-layout:fixed; border-collapse:collapse;">

                                        <!-- HEADER ROW 1 -->
                                        <tr>
                                            <th style="width:60px;">TOTAL<br/>میزان
                                            </th>
                                            <th style="width:60px;">MAX</th>
                                            <th style="width:60px;">GRACE</th>

                                            <th style="width:70px;">ANNUAL<br/>حاصل
                                            </th>
                                            <th style="width:50px;">MAX</th>

                                            <th style="width:70px;">HALF<br/>حاصل
                                            </th>
                                            <th style="width:50px;">MAX</th>

                                            <th colspan="2">SUBJECTS / مضامین</th>
                                        </tr>

                                        <!-- HEADER ROW 2 -->
                                        <tr>
                                            <th>OBT</th>
                                            <th>100</th>
                                            <th>G</th>

                                            <th>OBT</th>
                                            <th>50</th>

                                            <th>OBT</th>
                                            <th>50</th>

                                            <th colspan="2">NAME</th>
                                        </tr>

                                        <!-- INIT TOTALS -->
                                        <t t-set="t_total" t-value="0"/>
                                        <t t-set="t_total_max" t-value="0"/>
                                        <t t-set="t_grace" t-value="0"/>
                                        <t t-set="t_mo1" t-value="0"/>
                                        <t t-set="t_mo2" t-value="0"/>

                                        <!-- SUBJECT ROWS -->
                                        <t t-foreach="doc.student_marks_ids" t-as="line">

                                            <t t-set="t_total" t-value="t_total + line.total_mark"/>
                                            <t t-set="t_total_max" t-value="t_total_max + 100"/>
                                            <t t-set="t_grace" t-value="t_grace + line.grace_mark"/>
                                            <t t-set="t_mo1" t-value="t_mo1 + line.mo1"/>
                                            <t t-set="t_mo2" t-value="t_mo2 + line.mo2"/>

                                            <tr>
                                                <td>
                                                    <t t-esc="line.total_mark"/>
                                                </td>
                                                <td>100</td>
                                                <td>
                                                    <t t-esc="line.grace_mark"/>
                                                </td>

                                                <td>
                                                    <t t-esc="line.mo2"/>
                                                </td>
                                                <td>50</td>

                                                <td>
                                                    <t t-esc="line.mo1"/>
                                                </td>
                                                <td>50</td>

                                                <td colspan="2">
                                                    <t t-esc="line.subject_id.name"/>
                                                </td>
                                            </tr>
                                        </t>

                                        <!-- TOTALS ROW -->
                                        <tr class="totals">
                                            <td t-esc="t_total"/>
                                            <td t-esc="t_total_max"/>
                                            <td t-esc="t_grace"/>

                                            <td t-esc="t_mo2"/>
                                            <td>
                                                <t t-esc="len(doc.student_marks_ids)* 50"/>
                                            </td>

                                            <td t-esc="t_mo1"/>
                                            <td>
                                                <t t-esc="len(doc.student_marks_ids) * 50"/>
                                            </td>

                                            <td colspan="2" class="urdu">کل میزان</td>
                                        </tr>

                                    </table>
                                </div>

                            </td>
                        </tr>
                    </table>
                </div>

                <!-- Signature -->
                <div class="signature-sec">
                    <table>
                        <tr>
                            <td>DATE</td>
                            <td>دستخط سرپرست<br/>SIGN GUARDIAN
                            </td>
                            <td>و محط معلم درجہ<br/>SIG. CT
                            </td>
                            <td>دستخط صدر مدرس<br/>SIG. PRINCIPAL
                            </td>
                        </tr>

                        <tr>
                            <td></td>
                            <td>------------------</td>
                            <td>------------------</td>
                            <td>------------------</td>
                        </tr>
                    </table>
                </div>
            </div>
        </t>
    </template>





    <template id="report_exam_result">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="up_exam.exam_report_document"/>
            </t>
        </t>
    </template>

    <record id="paperformat_report_card1" model="report.paperformat">
        <field name="name">Report Card Print Format</field>
        <field name="default" eval="True"/>
        <field name="format">A4</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">2.8</field>
        <field name="margin_bottom">0</field>
        <field name="margin_left">0</field>
        <field name="margin_right">0</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="disable_shrinking" eval="True"/>
        <field name="dpi">96</field>
    </record>

    <record id="action_report_exam_result" model="ir.actions.report">
        <field name="name">Print Result.</field>
        <field name="model">exam.result</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">up_exam.report_exam_result</field>
        <field name="report_file">up_exam.report_exam_result</field>
        <field name="print_report_name">'Result'</field>
        <field name="binding_model_id" ref="model_exam_result"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_report_card1"/>
    </record>


</odoo>
